# ëª…ì°° ì¶œë ¥ í”„ë¡œê·¸ë¨ - í…œí”Œë¦¿ JSON êµì²´ ë¬¸ì œì  ë¶„ì„ ë¦¬í¬íŠ¸

## ğŸ“‹ í˜„ì¬ ìƒí™© ìš”ì•½

**ë¬¸ì œ**: í…œí”Œë¦¿ ë¶ˆëŸ¬ì˜¤ê¸° ì‹œ ìº”ë²„ìŠ¤ê°€ ê¸°ë³¸ì„¤ì •ìœ¼ë¡œë§Œ ì´ˆê¸°í™”ë˜ê³ , í…œí”Œë¦¿ì˜ JSON ë°ì´í„°ê°€ ì œëŒ€ë¡œ ë°˜ì˜ë˜ì§€ ì•ŠìŒ

**ì˜í–¥**: ì‚¬ìš©ìê°€ ì €ì¥í•œ í…œí”Œë¦¿ì„ ë¶ˆëŸ¬ì™€ë„ ì›ë˜ ë””ìì¸ì´ ë³µì›ë˜ì§€ ì•Šì•„ í…œí”Œë¦¿ ê¸°ëŠ¥ì´ ì‹¤ì§ˆì ìœ¼ë¡œ ì‘ë™í•˜ì§€ ì•ŠìŒ

---

## ğŸ—ï¸ í”„ë¡œì íŠ¸ êµ¬ì¡°

### ì£¼ìš” ì»´í¬ë„ŒíŠ¸ íŒŒì¼
```
components/
â”œâ”€â”€ CanvasEditor.js              # ê¸°ë³¸ ìº”ë²„ìŠ¤ ì—ë””í„° (936ì¤„)
â”œâ”€â”€ CanvasEditor_new.js          # ê³ ê¸‰ ìº”ë²„ìŠ¤ ì—ë””í„° (1054ì¤„) â† í˜„ì¬ ì‚¬ìš© ì¤‘
â”œâ”€â”€ CanvasEditor_backup.js       # ë°±ì—… íŒŒì¼
â”œâ”€â”€ CanvasEditor_fixed.js        # ìˆ˜ì •ëœ ë²„ì „
â”œâ”€â”€ EventDetailView.js           # ì´ë²¤íŠ¸ ìƒì„¸ ë·° (í…œí”Œë¦¿ ë¡œë“œ í˜¸ì¶œ)
â”œâ”€â”€ NamecardTemplateManager.js   # í…œí”Œë¦¿ ê´€ë¦¬ ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ NamecardTemplateSettings.js  # í…œí”Œë¦¿ ì„¤ì • ì»´í¬ë„ŒíŠ¸
â””â”€â”€ PropertyPanel.js             # ì†ì„± íŒ¨ë„
```

### ë°ì´í„°ë² ì´ìŠ¤ ê´€ë ¨ íŒŒì¼
```
lib/
â”œâ”€â”€ namecardDatabase.js          # í…œí”Œë¦¿ CRUD í•¨ìˆ˜ë“¤
â”œâ”€â”€ supabaseClient.js           # Supabase ì—°ê²°
â””â”€â”€ storage.js                  # ì´ë¯¸ì§€ ì €ì¥
```

### ë©”ëª¨ë¦¬ ë±…í¬
```
memory_bank/
â”œâ”€â”€ projectbrief.md             # í”„ë¡œì íŠ¸ ê°œìš”
â”œâ”€â”€ techContext.md              # ê¸°ìˆ  ìŠ¤íƒ ì •ë³´
â”œâ”€â”€ systemPatterns.md           # ì•„í‚¤í…ì²˜ íŒ¨í„´
â”œâ”€â”€ productContext.md           # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â””â”€â”€ progress.md                 # ì§„í–‰ ìƒí™©
```

---

## ğŸ” ë¬¸ì œì  ìƒì„¸ ë¶„ì„

### 1. **í…œí”Œë¦¿ ë¡œë“œ í”Œë¡œìš° ë¬¸ì œ**

#### í˜„ì¬ í”Œë¡œìš°:
```
EventDetailView.js 
  â†’ handleTemplateSelect(template)
  â†’ canvasRef.loadTemplate(template)
  â†’ CanvasEditor_new.js loadTemplate()
  â†’ loadOptimizedTemplate() ë˜ëŠ” loadFromJSON()
```

#### ë¬¸ì œì :
- **í…œí”Œë¦¿ ë°ì´í„° êµ¬ì¡° ë¶ˆì¼ì¹˜**: ì €ì¥ëœ JSONê³¼ ë¡œë“œ ì‹œ ê¸°ëŒ€í•˜ëŠ” êµ¬ì¡°ê°€ ë‹¤ë¦„
- **ì—ëŸ¬ ì²˜ë¦¬ ë¶€ì¡±**: JSON íŒŒì‹± ì‹¤íŒ¨ ì‹œ ê¸°ë³¸ í…œí”Œë¦¿ìœ¼ë¡œ ëŒ€ì²´ë˜ì–´ ë¬¸ì œê°€ ìˆ¨ê²¨ì§
- **ë¹„ë™ê¸° ì²˜ë¦¬ ë¬¸ì œ**: ì´ë¯¸ì§€ ë¡œë“œ ë“± ë¹„ë™ê¸° ì‘ì—…ì˜ ì™„ë£Œë¥¼ ê¸°ë‹¤ë¦¬ì§€ ì•ŠìŒ

### 2. **JSON ë°ì´í„° êµ¬ì¡° ë¬¸ì œ**

#### ì €ì¥ë˜ëŠ” JSON êµ¬ì¡° (namecardDatabase.js):
```javascript
{
  event_id: eventId,
  template_name: templateName,
  canvas_json: canvasJson,  // â† ì‹¤ì œ ìº”ë²„ìŠ¤ JSONì´ ì—¬ê¸°ì— ì €ì¥ë¨
  is_default: false,
  // ... ê¸°íƒ€ ë©”íƒ€ë°ì´í„°
}
```

#### ë¡œë“œ ì‹œ ê¸°ëŒ€í•˜ëŠ” êµ¬ì¡° (CanvasEditor_new.js):
```javascript
// loadOptimizedTemplateì—ì„œ ê¸°ëŒ€í•˜ëŠ” êµ¬ì¡°
if (templateData.version === '1.0') {
  // ìµœì í™”ëœ JSON ì²˜ë¦¬
  loadOptimizedTemplate(canvas, templateData)
} else {
  // ê¸°ì¡´ Fabric.js JSON ì²˜ë¦¬
  canvas.loadFromJSON(jsonData, ...)
}
```

#### **í•µì‹¬ ë¬¸ì œ**: 
- `template.canvas_json`ì´ ì‹¤ì œ ìº”ë²„ìŠ¤ JSONì¸ë°, `templateData`ë¡œ ì§ì ‘ ì‚¬ìš©
- `templateData.version`ì„ í™•ì¸í•˜ì§€ë§Œ `template.canvas_json.version`ì„ í™•ì¸í•´ì•¼ í•¨

### 3. **ì½”ë“œ ë¶„ì„ ê²°ê³¼**

#### EventDetailView.js (79-92ì¤„):
```javascript
const handleTemplateSelect = (template) => {
  console.log('EventDetailView handleTemplateSelect called:', template)
  
  if (canvasRef.current) {
    // canvasRef.loadTemplate(template) í˜¸ì¶œ
    canvasRef.loadTemplate(template)
  } else {
    // ìº”ë²„ìŠ¤ê°€ ì¤€ë¹„ë˜ì§€ ì•Šì€ ê²½ìš° ëŒ€ê¸°
    setTimeout(() => {
      if (canvasRef.current) {
        canvasRef.loadTemplate(template)
      }
    }, 100)
  }
}
```

#### CanvasEditor_new.js loadTemplate() (454-525ì¤„):
```javascript
const loadTemplate = (template) => {
  // ...
  if (!template.canvas_json) {
    console.error('Template JSON data not provided')
    return
  }
  
  const templateData = template.canvas_json  // â† ì—¬ê¸°ì„œ ë¬¸ì œ!
  
  // templateData.versionì„ í™•ì¸í•˜ì§€ë§Œ ì‹¤ì œë¡œëŠ” template.canvas_json.versionì„ í™•ì¸í•´ì•¼ í•¨
  if (templateData.version === '1.0') {
    loadOptimizedTemplate(canvas, templateData)
  } else {
    // ê¸°ì¡´ Fabric.js JSON ì²˜ë¦¬
  }
}
```

---

## ğŸ› êµ¬ì²´ì ì¸ ë²„ê·¸ë“¤

### 1. **JSON êµ¬ì¡° ì ‘ê·¼ ì˜¤ë¥˜**
```javascript
// í˜„ì¬ (ì˜ëª»ëœ ì½”ë“œ)
const templateData = template.canvas_json
if (templateData.version === '1.0') { ... }

// ìˆ˜ì •í•´ì•¼ í•  ì½”ë“œ
const templateData = template.canvas_json
if (templateData && templateData.version === '1.0') { ... }
```

### 2. **ì—ëŸ¬ ì²˜ë¦¬ ë¶€ì¡±**
```javascript
// í˜„ì¬: ì—ëŸ¬ ë°œìƒ ì‹œ ê¸°ë³¸ í…œí”Œë¦¿ìœ¼ë¡œ ëŒ€ì²´
catch (error) {
  console.error('Error loading template:', error)
  createDefaultTemplate(canvas)  // â† ë¬¸ì œë¥¼ ìˆ¨ê¹€
}

// ê°œì„  í•„ìš”: ì—ëŸ¬ë¥¼ ì‚¬ìš©ìì—ê²Œ ì•Œë¦¬ê³  ë””ë²„ê¹… ì •ë³´ ì œê³µ
```

### 3. **ë¹„ë™ê¸° ì²˜ë¦¬ ë¬¸ì œ**
```javascript
// ì´ë¯¸ì§€ ë¡œë“œê°€ ì™„ë£Œë˜ê¸° ì „ì— renderAll() í˜¸ì¶œ
fabric.Image.fromURL(objData.src, (img) => {
  // ... ì´ë¯¸ì§€ ì„¤ì •
  canvas.add(img)
  canvas.renderAll()  // â† ì´ë¯¸ì§€ê°€ ì™„ì „íˆ ë¡œë“œë˜ê¸° ì „ì— ë Œë”ë§
})
```

### 4. **ë””ë²„ê¹… ì •ë³´ ë¶€ì¡±**
- ì½˜ì†” ë¡œê·¸ëŠ” ìˆì§€ë§Œ ì‹¤ì œ JSON êµ¬ì¡°ë¥¼ í™•ì¸í•  ìˆ˜ ì—†ìŒ
- í…œí”Œë¦¿ ë¡œë“œ ì‹¤íŒ¨ ì‹œ êµ¬ì²´ì ì¸ ì›ì¸ì„ ì•Œ ìˆ˜ ì—†ìŒ

---

## ğŸ”§ í•´ê²° ë°©ì•ˆ

### 1. **ì¦‰ì‹œ ìˆ˜ì • í•„ìš”**
```javascript
// CanvasEditor_new.js loadTemplate() í•¨ìˆ˜ ìˆ˜ì •
const loadTemplate = (template) => {
  console.log('Loading template:', template)
  console.log('Template canvas_json:', template.canvas_json)
  
  if (!template || !template.canvas_json) {
    console.error('Template or canvas_json not provided')
    return
  }
  
  const templateData = template.canvas_json
  
  // JSON êµ¬ì¡° ê²€ì¦ ì¶”ê°€
  if (!templateData || typeof templateData !== 'object') {
    console.error('Invalid template JSON data:', templateData)
    return
  }
  
  // ë²„ì „ í™•ì¸ ìˆ˜ì •
  if (templateData.version === '1.0') {
    loadOptimizedTemplate(canvas, templateData)
  } else {
    // ê¸°ì¡´ Fabric.js JSON ì²˜ë¦¬
  }
}
```

### 2. **ë””ë²„ê¹… ê°•í™”**
```javascript
// JSON êµ¬ì¡°ë¥¼ ì½˜ì†”ì— ì¶œë ¥
console.log('Template data structure:', {
  hasVersion: !!templateData.version,
  version: templateData.version,
  hasObjects: !!templateData.objects,
  objectCount: templateData.objects?.length || 0,
  hasCanvas: !!templateData.canvas
})
```

### 3. **ì—ëŸ¬ ì²˜ë¦¬ ê°œì„ **
```javascript
// ì—ëŸ¬ ë°œìƒ ì‹œ ê¸°ë³¸ í…œí”Œë¦¿ ëŒ€ì‹  ì—ëŸ¬ í‘œì‹œ
catch (error) {
  console.error('Error loading template:', error)
  alert(`í…œí”Œë¦¿ ë¡œë“œ ì‹¤íŒ¨: ${error.message}`)
  // createDefaultTemplate(canvas) ì œê±°
}
```

---

## ğŸ“Š ì—°ê´€ íŒŒì¼ ë° ì˜ì¡´ì„±

### ì§ì ‘ ì—°ê´€ íŒŒì¼
1. **components/CanvasEditor_new.js** - ë©”ì¸ ìº”ë²„ìŠ¤ ì—ë””í„°
2. **components/EventDetailView.js** - í…œí”Œë¦¿ ë¡œë“œ í˜¸ì¶œ
3. **components/NamecardTemplateManager.js** - í…œí”Œë¦¿ ê´€ë¦¬
4. **lib/namecardDatabase.js** - í…œí”Œë¦¿ ì €ì¥/ë¡œë“œ í•¨ìˆ˜

### ê°„ì ‘ ì—°ê´€ íŒŒì¼
1. **components/PropertyPanel.js** - ì†ì„± íŒ¨ë„ (í…œí”Œë¦¿ ë¡œë“œ í›„ ì—°ë™)
2. **lib/supabaseClient.js** - ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
3. **memory_bank/progress.md** - ì§„í–‰ ìƒí™© ê¸°ë¡

### ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”
- **namecards** í…Œì´ë¸”: í…œí”Œë¦¿ ë°ì´í„° ì €ì¥
  - `canvas_json` ì»¬ëŸ¼: ì‹¤ì œ ìº”ë²„ìŠ¤ JSON ë°ì´í„°
  - `template_name`: í…œí”Œë¦¿ ì´ë¦„
  - `event_id`: ì´ë²¤íŠ¸ ID

---

## ğŸ¯ ìš°ì„ ìˆœìœ„ë³„ í•´ê²° ê³„íš

### 1ë‹¨ê³„: ì¦‰ì‹œ ìˆ˜ì • (High Priority)
- [ ] JSON êµ¬ì¡° ì ‘ê·¼ ì˜¤ë¥˜ ìˆ˜ì •
- [ ] ë””ë²„ê¹… ë¡œê·¸ ì¶”ê°€
- [ ] ì—ëŸ¬ ì²˜ë¦¬ ê°œì„ 

### 2ë‹¨ê³„: ê¸°ëŠ¥ ê°œì„  (Medium Priority)
- [ ] ë¹„ë™ê¸° ì²˜ë¦¬ ê°œì„ 
- [ ] í…œí”Œë¦¿ ê²€ì¦ ë¡œì§ ì¶”ê°€
- [ ] ì‚¬ìš©ì í”¼ë“œë°± ê°œì„ 

### 3ë‹¨ê³„: ì¥ê¸° ê°œì„  (Low Priority)
- [ ] í…œí”Œë¦¿ ë²„ì „ ê´€ë¦¬ ì‹œìŠ¤í…œ
- [ ] ìë™ ë°±ì—… ê¸°ëŠ¥
- [ ] í…œí”Œë¦¿ ë¯¸ë¦¬ë³´ê¸° ê¸°ëŠ¥

---

## ğŸ“ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### 1. **ê¸°ë³¸ í…œí”Œë¦¿ ë¡œë“œ í…ŒìŠ¤íŠ¸**
1. í…œí”Œë¦¿ ì €ì¥
2. í…œí”Œë¦¿ ë¶ˆëŸ¬ì˜¤ê¸°
3. ìº”ë²„ìŠ¤ì— ê°ì²´ë“¤ì´ ì •í™•íˆ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸

### 2. **ì—ëŸ¬ ìƒí™© í…ŒìŠ¤íŠ¸**
1. ì˜ëª»ëœ JSON êµ¬ì¡°ì˜ í…œí”Œë¦¿ ë¡œë“œ
2. ë¹ˆ í…œí”Œë¦¿ ë¡œë“œ
3. ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ìƒí™©

### 3. **ë³µí•© ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸**
1. í…œí”Œë¦¿ ì €ì¥ â†’ ë¶ˆëŸ¬ì˜¤ê¸° â†’ ìˆ˜ì • â†’ ë‹¤ì‹œ ì €ì¥
2. ì—¬ëŸ¬ í…œí”Œë¦¿ ê°„ ì „í™˜
3. ì´ë¯¸ì§€ê°€ í¬í•¨ëœ í…œí”Œë¦¿ ë¡œë“œ

---

## ğŸ” ë””ë²„ê¹…ì„ ìœ„í•œ ì¶”ê°€ ì •ë³´

### í˜„ì¬ ì‚¬ìš© ì¤‘ì¸ íŒŒì¼
- **ë©”ì¸ ìº”ë²„ìŠ¤**: `components/CanvasEditor_new.js`
- **í…œí”Œë¦¿ ë¡œë“œ í˜¸ì¶œ**: `components/EventDetailView.js`
- **ë°ì´í„°ë² ì´ìŠ¤**: `lib/namecardDatabase.js`

### ì£¼ìš” í•¨ìˆ˜ë“¤
- `loadTemplate()`: í…œí”Œë¦¿ ë¡œë“œ ë©”ì¸ í•¨ìˆ˜
- `loadOptimizedTemplate()`: ìµœì í™”ëœ JSON ì²˜ë¦¬
- `handleTemplateSelect()`: í…œí”Œë¦¿ ì„ íƒ í•¸ë“¤ëŸ¬
- `saveNamecardTemplate()`: í…œí”Œë¦¿ ì €ì¥ í•¨ìˆ˜

### ì½˜ì†” ë¡œê·¸ í‚¤ì›Œë“œ
- "Loading template:"
- "Template JSON loaded, rendering..."
- "Optimized template loaded successfully"
- "Error loading template:"

---

**ì‘ì„±ì¼**: 2025ë…„ 1ì›” 13ì¼  
**ì‘ì„±ì**: Cursor AI Assistant  
**í”„ë¡œì íŠ¸**: ëª…ì°° ì¶œë ¥ í”„ë¡œê·¸ë¨  
**ìƒíƒœ**: ë¬¸ì œ ë¶„ì„ ì™„ë£Œ, í•´ê²° ë°©ì•ˆ ì œì‹œ
