# 배경 이미지 모달 수정 완료

## 문제점
배경 이미지 버튼을 클릭해도 이미지 업로드 모달이 나타나지 않음

## 수정 내용

### 1. 상태 선언 순서 수정
- `showBackgroundImageModal` 상태를 다른 상태들과 함께 상단에 선언
- `handleBackgroundImage` 함수가 상태를 사용할 수 있도록 순서 조정

### 2. 모달 z-index 증가
- `z-50` → `z-[9999]`로 변경하여 다른 요소에 가려지지 않도록 함

### 3. 모달 클릭 이벤트 처리
- 모달 배경 클릭 시 닫기 기능 추가
- 모달 내용 클릭 시 이벤트 전파 방지

### 4. 디버깅 로그 추가
- 버튼 클릭 시 콘솔 로그 출력
- 모달 상태 변경 시 로그 출력
- 문제 추적을 위한 상세 로그

### 5. useCallback 최적화
- `handleBackgroundImage` 함수를 `useCallback`으로 감싸서 안정적인 참조 유지
- 의존성 배열은 빈 배열로 설정 (setState는 안정적)

## 수정된 파일

1. **components/EventDetailView_new.js**
   - 상태 선언 순서 수정
   - `handleBackgroundImage` 함수 개선
   - 모달 z-index 및 클릭 이벤트 처리 개선

2. **components/CanvasViewport.js**
   - 버튼 클릭 이벤트에 디버깅 로그 추가
   - 이벤트 전파 방지 추가

## 테스트 방법

1. 브라우저 강력 새로고침 (Ctrl+F5)
2. 편집 화면에서 "배경 이미지" 버튼 클릭
3. 콘솔 확인:
   - "Background image button clicked in CanvasViewport" 메시지 확인
   - "Background image button clicked, opening modal" 메시지 확인
   - "Previous modal state: false Setting to true" 메시지 확인
4. 모달 표시 확인:
   - 배경 이미지 선택 모달이 화면 중앙에 표시되는지 확인
   - ImageUploadLibrary 컴포넌트가 표시되는지 확인

## 예상 결과

- ✅ 배경 이미지 버튼 클릭 시 모달이 정상적으로 표시됨
- ✅ 모달 배경 클릭 시 모달이 닫힘
- ✅ 이미지 선택 시 배경 이미지가 적용됨
- ✅ 콘솔에 디버깅 로그가 출력됨

---

**수정 완료일**: 2025-01-27  
**수정된 파일**:
- `components/EventDetailView_new.js`
- `components/CanvasViewport.js`

